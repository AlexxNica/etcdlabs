<md-sidenav-layout>
    <md-sidenav #sidenav [opened]="true" mode="side" class="doc-sidenav">
        <md-list>
            <a routerLink="/doc/{{version.etcdVersionURL}}">
                <h3 md-subheader>Getting Started ({{version.etcdVersion}})</h3>
            </a>
            <md-list-item *ngFor="let item of getStartedItems">
                <a routerLink="{{item.url}}" class="{{item.htmlClass}}">{{item.title}}</a>
            </md-list-item>

            <md-divider></md-divider>

            <h3 md-subheader>More</h3>
            <md-list-item *ngFor="let item of moreItems">
                <a routerLink="{{item.url}}" class="{{item.htmlClass}}">{{item.title}}</a>
            </md-list-item>
        </md-list>
    </md-sidenav>

    <!--TODO: configuration generator with latest version-->
    <div class="doc-group">
        <router-outlet></router-outlet>

        <h4>
            Install and Deploy etcd <span class="versions-link-main-emphasize">{{inputVersion}}</span> <span class="versions-link-normal">(latest {{etcdVersionLatestRelease}})</span>
        </h4>
        <md-card>
            <md-card-subtitle>TLS</md-card-subtitle>
            <md-input type="text" [(ngModel)]="inputOrganization" placeholder="Organization"></md-input>
            <md-input type="text" [(ngModel)]="inputOrganizationUnit" placeholder="Organization Unit"></md-input>
            <md-input type="text" [(ngModel)]="inputLocationCity" placeholder="City"></md-input>
            <md-input type="text" [(ngModel)]="inputLocationState" placeholder="State"></md-input>
            <md-input type="text" [(ngModel)]="inputLocationCountry" placeholder="Country"></md-input>
            <br>
            <md-input type="text" [(ngModel)]="inputKeyAlgorithm" placeholder="Key Algorithm"></md-input>
            <md-input type="number" [(ngModel)]="inputKeySize" placeholder="Key Size"></md-input>
            <md-input type="number" [(ngModel)]="inputKeyExpirationHour" placeholder="Key Expiration (hour)"></md-input>
            <br>
            <md-input type="text" [(ngModel)]="inputCommonName" placeholder="Common Name"></md-input>
        </md-card>

        <md-card>
            <md-card-subtitle>etcd flags</md-card-subtitle>
            <md-checkbox [(ngModel)]="inputSecure">Secure connection (HTTPS)</md-checkbox>
            <md-checkbox [(ngModel)]="inputEnableProfile">Enable profiler</md-checkbox>
            <md-checkbox [(ngModel)]="inputDebug">Debug mode</md-checkbox>
            <p></p>
            <md-input type="text" [(ngModel)]="inputVersion" placeholder="etcd version"></md-input>
            <md-input type="number" [(ngModel)]="inputClusterSize" placeholder="Cluster size (up to 7)"></md-input>
            <span *ngIf="inputClusterSize > 7" class="error-message">This tool only supports up to 7 nodes</span>
            <span *ngIf="inputClusterSize < 1" class="error-message">Minimum cluster size is 1</span>
            <span *ngIf="inputClusterSize % 2 == 0" class="error-message">Cluster size should an odd number</span>
            <br>

            <div *ngFor="let flag of flags; let i = index;">
                <div *ngIf="inputClusterSize > i">
                    <br>
                    <md-card-subtitle class="sub-sub-title">Node {{i+1}}</md-card-subtitle>
                    <md-input type="text" [(ngModel)]="flag.name" placeholder="etcd name"></md-input>
                    <md-input type="text" [(ngModel)]="flag.dataDir" placeholder="data directory"></md-input>
                    <md-input type="text" [(ngModel)]="flag.ipAddress" placeholder="IP address"></md-input>
                    <md-input type="number" [(ngModel)]="flag.clientPort" placeholder="client port"></md-input>
                    <md-input type="number" [(ngModel)]="flag.peerPort" placeholder="peer port"></md-input>
                    <br>
                    <md-input type="text" [(ngModel)]="flag.initialClusterToken" placeholder="cluster token"></md-input>
                    <md-input type="text" [(ngModel)]="flag.initialClusterState" placeholder="cluster state"></md-input>
                    <span *ngIf="flag.initialClusterState != 'new' && flag.initialClusterState != 'existing'" class="error-message">Cluster state must be either 'new' or 'existing'</span>
                    <br>
                    <md-input type="text" [(ngModel)]="flag.clientCertFile" placeholder="client cert"></md-input>
                    <md-input type="text" [(ngModel)]="flag.clientKeyFile" placeholder="client key"></md-input>
                    <md-input type="text" [(ngModel)]="flag.clientTrustedCAFile" placeholder="client CA"></md-input>
                    <br>
                    <md-input type="text" [(ngModel)]="flag.peerCertFile" placeholder="peer cert"></md-input>
                    <md-input type="text" [(ngModel)]="flag.peerKeyFile" placeholder="peer key"></md-input>
                    <md-input type="text" [(ngModel)]="flag.peerTrustedCAFile" placeholder="peer CA"></md-input>
                </div>
            </div>

            <br>
            <md-card-actions>
                <a href="{{version.etcdFlagPage}}" target="_blank"><button md-button color="warn">More flags</button></a>
            </md-card-actions>
        </md-card>

        <br><br>
        <h4>Generated Commands</h4>
        <md-tab-group>
            <md-tab>
                <template md-tab-label>
					TLS
				</template>
                <template md-tab-content>
					<p>etcd {{inputVersion}}</p>
				</template>
            </md-tab>
            <md-tab>
                <template md-tab-label>
					Baremetal, VM
				</template>
                <template md-tab-content>
					<h5 style="line-height: 0.07;">Initial Setting</h5>
					<pre class="code-dark">{{getEtcdCommandInitial()}}</pre>

					<br>
					<h5 style="line-height: 0.07;">Install on Linux</h5>
					<pre class="code-dark">{{getEtcdCommandInstallLinux()}}</pre>

					<br>
					<h5 style="line-height: 0.07;">Install on Mac OS (Darwin)</h5>
					<pre class="code-dark">{{getEtcdCommandInstallOSX()}}</pre>

					<br>
					<h5 style="line-height: 0.07;">Deploy Cluster</h5>
					<div *ngFor="let flag of flags; let i = index;">
						<div *ngIf="inputClusterSize > i">
							<pre class="code-dark">{{getEtcdCommandBash(flag)}}</pre>
						</div>
					</div>
				</template>
            </md-tab>
            <md-tab>
                <template md-tab-label>
					rkt
				</template>
                <template md-tab-content>
					<p>etcd {{inputVersion}}</p>
				</template>
            </md-tab>
        </md-tab-group>
    </div>
</md-sidenav-layout>